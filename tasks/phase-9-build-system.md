# Phase 9: Build System

## Objective

Implement a comprehensive CMake-based build system with full Playdate SDK integration, cross-platform support, and automated testing. This system provides developers with a streamlined workflow for building, testing, and deploying Playdate games using the engine.

## Prerequisites

- **Phase 1-8**: Complete engine implementation
- CMake 3.19+ knowledge
- Playdate SDK build system understanding
- Cross-platform development experience

## Technical Specifications

### Build System Goals
- **CMake integration**: Modern CMake practices with target-based configuration
- **Playdate SDK**: Seamless integration with official SDK toolchain
- **Cross-platform**: Support for macOS, Windows, and Linux development
- **Testing integration**: Automated unit testing and benchmarking
- **Asset pipeline**: Automated asset processing and optimization

### Supported Configurations
- **Debug**: Full debugging information, assertions enabled
- **Release**: Optimized builds for device deployment
- **Testing**: Special configuration for running automated tests
- **Profiling**: Performance analysis builds with profiling support

## Code Structure

```
/
├── CMakeLists.txt              # Root CMake configuration
├── cmake/                      # CMake modules and utilities
│   ├── PlaydateSDK.cmake      # Playdate SDK integration
│   ├── Testing.cmake          # Testing configuration
│   ├── Assets.cmake           # Asset processing
│   └── Packaging.cmake        # Distribution packaging
├── src/
│   └── CMakeLists.txt         # Source code build configuration
├── tests/
│   └── CMakeLists.txt         # Test build configuration
├── examples/
│   └── CMakeLists.txt         # Example projects configuration
├── scripts/                   # Build automation scripts
│   ├── build.sh              # Unix build script
│   ├── build.bat             # Windows build script
│   ├── test.sh               # Testing script
│   └── package.sh            # Packaging script
└── docs/                      # Build documentation
    ├── BUILD.md               # Build instructions
    ├── DEVELOPMENT.md         # Development setup
    └── DEPLOYMENT.md          # Deployment guide
```

## Implementation Steps

### Step 1: Root CMakeLists.txt

```cmake\n# CMakeLists.txt\ncmake_minimum_required(VERSION 3.19)\n\n# Project configuration\nproject(PlaydateEngine \n    VERSION 1.0.0\n    DESCRIPTION \"High-performance game development engine for Playdate\"\n    LANGUAGES C CXX\n)\n\n# Set C standard\nset(CMAKE_C_STANDARD 11)\nset(CMAKE_C_STANDARD_REQUIRED ON)\nset(CMAKE_C_EXTENSIONS OFF)\n\n# Build options\noption(ENABLE_LUA_BINDINGS \"Enable Lua scripting support\" ON)\noption(ENABLE_TESTING \"Enable unit testing\" ON)\noption(ENABLE_EXAMPLES \"Build example projects\" ON)\noption(ENABLE_PROFILING \"Enable profiling support\" OFF)\noption(BUILD_SHARED_LIBS \"Build shared libraries\" OFF)\n\n# Platform detection\nif(CMAKE_SYSTEM_NAME STREQUAL \"Darwin\")\n    set(PLAYDATE_PLATFORM \"Mac\")\nelseif(CMAKE_SYSTEM_NAME STREQUAL \"Windows\")\n    set(PLAYDATE_PLATFORM \"Windows\")\nelseif(CMAKE_SYSTEM_NAME STREQUAL \"Linux\")\n    set(PLAYDATE_PLATFORM \"Linux\")\nelse()\n    message(FATAL_ERROR \"Unsupported platform: ${CMAKE_SYSTEM_NAME}\")\nendif()\n\n# Playdate SDK path configuration\nif(NOT DEFINED PLAYDATE_SDK_PATH)\n    if(DEFINED ENV{PLAYDATE_SDK_PATH})\n        set(PLAYDATE_SDK_PATH $ENV{PLAYDATE_SDK_PATH})\n    else()\n        # Try common default locations\n        if(PLAYDATE_PLATFORM STREQUAL \"Mac\")\n            set(PLAYDATE_SDK_PATH \"/Users/matheusmortatti/Playdate\")\n        elseif(PLAYDATE_PLATFORM STREQUAL \"Windows\")\n            set(PLAYDATE_SDK_PATH \"C:/Users/$ENV{USERNAME}/Documents/PlaydateSDK\")\n        endif()\n    endif()\nendif()\n\n# Validate Playdate SDK\nif(NOT EXISTS \"${PLAYDATE_SDK_PATH}/C_API/pd_api.h\")\n    message(FATAL_ERROR \"Playdate SDK not found at: ${PLAYDATE_SDK_PATH}\")\nendif()\n\nmessage(STATUS \"Using Playdate SDK: ${PLAYDATE_SDK_PATH}\")\n\n# Include CMake modules\nlist(APPEND CMAKE_MODULE_PATH \"${CMAKE_CURRENT_SOURCE_DIR}/cmake\")\ninclude(PlaydateSDK)\ninclude(Testing)\ninclude(Assets)\n\n# Compiler flags\nif(CMAKE_C_COMPILER_ID STREQUAL \"Clang\" OR CMAKE_C_COMPILER_ID STREQUAL \"GNU\")\n    set(ENGINE_C_FLAGS\n        -Wall\n        -Wextra\n        -Wpedantic\n        -Wno-unused-parameter\n        -ffast-math\n    )\n    \n    if(CMAKE_BUILD_TYPE STREQUAL \"Debug\")\n        list(APPEND ENGINE_C_FLAGS -g -O0 -DDEBUG=1)\n    elseif(CMAKE_BUILD_TYPE STREQUAL \"Release\")\n        list(APPEND ENGINE_C_FLAGS -O3 -DNDEBUG=1 -flto)\n    endif()\nendif()\n\n# Global definitions\nadd_compile_definitions(\n    ENGINE_VERSION=\"${PROJECT_VERSION}\"\n    PLAYDATE_SDK_PATH=\"${PLAYDATE_SDK_PATH}\"\n)\n\nif(ENABLE_LUA_BINDINGS)\n    add_compile_definitions(ENABLE_LUA_BINDINGS=1)\nendif()\n\n# Include directories\ninclude_directories(\n    ${CMAKE_CURRENT_SOURCE_DIR}/include\n    ${PLAYDATE_SDK_PATH}/C_API\n)\n\n# Subdirectories\nadd_subdirectory(src)\n\nif(ENABLE_TESTING)\n    enable_testing()\n    add_subdirectory(tests)\nendif()\n\nif(ENABLE_EXAMPLES)\n    add_subdirectory(examples)\nendif()\n\n# Installation configuration\ninclude(GNUInstallDirs)\ninstall(DIRECTORY include/ DESTINATION ${CMAKE_INSTALL_INCLUDEDIR})\ninstall(DIRECTORY lua/ DESTINATION ${CMAKE_INSTALL_DATADIR}/playdate-engine/lua)\n\n# Package configuration\ninclude(Packaging)\n```\n\n### Step 2: Playdate SDK Integration\n\n```cmake\n# cmake/PlaydateSDK.cmake\n\n# Playdate SDK integration module\n\n# Find Playdate toolchain\nif(PLAYDATE_PLATFORM STREQUAL \"Mac\")\n    set(PLAYDATE_C_COMPILER \"${PLAYDATE_SDK_PATH}/bin/gcc-arm-none-eabi\")\n    set(PLAYDATE_SIMULATOR_COMPILER \"clang\")\nelseif(PLAYDATE_PLATFORM STREQUAL \"Windows\")\n    set(PLAYDATE_C_COMPILER \"${PLAYDATE_SDK_PATH}/bin/gcc-arm-none-eabi.exe\")\n    set(PLAYDATE_SIMULATOR_COMPILER \"clang\")\nelse()\n    message(FATAL_ERROR \"Unsupported platform for Playdate development\")\nendif()\n\n# Target type selection\nif(NOT DEFINED PLAYDATE_TARGET)\n    set(PLAYDATE_TARGET \"simulator\" CACHE STRING \"Build target: simulator or device\")\nendif()\n\nset_property(CACHE PLAYDATE_TARGET PROPERTY STRINGS \"simulator\" \"device\")\n\n# Compiler and flags configuration\nif(PLAYDATE_TARGET STREQUAL \"device\")\n    # Device build configuration\n    set(CMAKE_SYSTEM_NAME Generic)\n    set(CMAKE_SYSTEM_PROCESSOR arm)\n    set(CMAKE_C_COMPILER ${PLAYDATE_C_COMPILER})\n    set(CMAKE_CXX_COMPILER ${PLAYDATE_C_COMPILER})\n    \n    set(PLAYDATE_DEVICE_FLAGS\n        -mcpu=cortex-m7\n        -mthumb\n        -mfpu=fpv5-sp-d16\n        -mfloat-abi=hard\n        -D__FPU_USED=1\n        -DTARGET_PLAYDATE=1\n        -DTARGET_EXTENSION=1\n    )\n    \n    set(CMAKE_C_FLAGS \"${CMAKE_C_FLAGS} ${PLAYDATE_DEVICE_FLAGS}\")\n    set(CMAKE_EXE_LINKER_FLAGS \"${CMAKE_EXE_LINKER_FLAGS} -nostartfiles\")\n    \nelse()\n    # Simulator build configuration\n    set(CMAKE_C_COMPILER ${PLAYDATE_SIMULATOR_COMPILER})\n    set(CMAKE_CXX_COMPILER ${PLAYDATE_SIMULATOR_COMPILER})\n    \n    set(PLAYDATE_SIMULATOR_FLAGS\n        -DTARGET_SIMULATOR=1\n    )\n    \n    if(PLAYDATE_PLATFORM STREQUAL \"Mac\")\n        list(APPEND PLAYDATE_SIMULATOR_FLAGS -arch x86_64 -arch arm64)\n    endif()\n    \n    set(CMAKE_C_FLAGS \"${CMAKE_C_FLAGS} ${PLAYDATE_SIMULATOR_FLAGS}\")\nendif()\n\n# Playdate library target\nfunction(add_playdate_game TARGET_NAME)\n    cmake_parse_arguments(PLAYDATE_GAME\n        \"\" # No boolean options\n        \"SOURCE_DIR;ASSETS_DIR;OUTPUT_NAME\" # Single value options\n        \"SOURCES;LIBRARIES;INCLUDE_DIRS\" # Multi-value options\n        ${ARGN}\n    )\n    \n    # Set defaults\n    if(NOT PLAYDATE_GAME_SOURCE_DIR)\n        set(PLAYDATE_GAME_SOURCE_DIR ${CMAKE_CURRENT_SOURCE_DIR})\n    endif()\n    \n    if(NOT PLAYDATE_GAME_OUTPUT_NAME)\n        set(PLAYDATE_GAME_OUTPUT_NAME ${TARGET_NAME})\n    endif()\n    \n    # Create executable target\n    add_executable(${TARGET_NAME} ${PLAYDATE_GAME_SOURCES})\n    \n    # Link libraries\n    target_link_libraries(${TARGET_NAME} \n        playdate-engine\n        ${PLAYDATE_GAME_LIBRARIES}\n    )\n    \n    # Include directories\n    if(PLAYDATE_GAME_INCLUDE_DIRS)\n        target_include_directories(${TARGET_NAME} PRIVATE ${PLAYDATE_GAME_INCLUDE_DIRS})\n    endif()\n    \n    # Platform-specific configuration\n    if(PLAYDATE_TARGET STREQUAL \"device\")\n        # Device-specific linking\n        target_link_libraries(${TARGET_NAME} \n            \"${PLAYDATE_SDK_PATH}/C_API/buildsupport/setup.c\"\n        )\n        \n        set_target_properties(${TARGET_NAME} PROPERTIES\n            SUFFIX \".elf\"\n            LINK_FLAGS \"-T${PLAYDATE_SDK_PATH}/C_API/buildsupport/link_map.ld\"\n        )\n        \n    else()\n        # Simulator-specific linking\n        if(PLAYDATE_PLATFORM STREQUAL \"Mac\")\n            target_link_libraries(${TARGET_NAME} \n                \"-framework CoreFoundation\"\n                \"-framework CoreGraphics\"\n                \"-framework CoreText\"\n                \"-framework Foundation\"\n            )\n            \n            set_target_properties(${TARGET_NAME} PROPERTIES\n                SUFFIX \".dylib\"\n                BUNDLE TRUE\n            )\n        endif()\n    endif()\n    \n    # Asset processing\n    if(PLAYDATE_GAME_ASSETS_DIR)\n        process_playdate_assets(${TARGET_NAME} ${PLAYDATE_GAME_ASSETS_DIR})\n    endif()\n    \nendfunction()\n\n# Asset processing function\nfunction(process_playdate_assets TARGET_NAME ASSETS_DIR)\n    if(NOT EXISTS ${ASSETS_DIR})\n        message(WARNING \"Assets directory not found: ${ASSETS_DIR}\")\n        return()\n    endif()\n    \n    # Find all asset files\n    file(GLOB_RECURSE ASSET_FILES \n        \"${ASSETS_DIR}/*.png\"\n        \"${ASSETS_DIR}/*.wav\"\n        \"${ASSETS_DIR}/*.aiff\"\n        \"${ASSETS_DIR}/*.fnt\"\n        \"${ASSETS_DIR}/*.lua\"\n    )\n    \n    # Process each asset\n    foreach(ASSET_FILE ${ASSET_FILES})\n        get_filename_component(ASSET_NAME ${ASSET_FILE} NAME)\n        \n        # Copy to build directory\n        configure_file(${ASSET_FILE} \n            \"${CMAKE_CURRENT_BINARY_DIR}/assets/${ASSET_NAME}\"\n            COPYONLY\n        )\n    endforeach()\n    \nendfunction()\n```\n\n### Step 3: Source Code Build Configuration\n\n```cmake\n# src/CMakeLists.txt\n\n# Engine core library\nset(ENGINE_CORE_SOURCES\n    core/memory_pool.c\n    core/component.c\n    core/component_registry.c\n    core/game_object.c\n    core/scene.c\n    core/transform_component.c\n    \n    systems/spatial_grid.c\n    systems/update_systems.c\n    \n    components/sprite_component.c\n    components/collision_component.c\n    \n    physics/aabb.c\n    physics/collision_system.c\n)\n\n# Lua bindings (optional)\nif(ENABLE_LUA_BINDINGS)\n    list(APPEND ENGINE_CORE_SOURCES\n        bindings/lua_engine.c\n        bindings/lua_gameobject.c\n        bindings/lua_components.c\n        bindings/lua_scene.c\n        bindings/lua_math.c\n    )\nendif()\n\n# Create engine library\nadd_library(playdate-engine ${ENGINE_CORE_SOURCES})\n\n# Compiler flags\ntarget_compile_options(playdate-engine PRIVATE ${ENGINE_C_FLAGS})\n\n# Include directories\ntarget_include_directories(playdate-engine\n    PUBLIC\n        $<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}>\n        $<BUILD_INTERFACE:${CMAKE_SOURCE_DIR}/include>\n        $<INSTALL_INTERFACE:include>\n    PRIVATE\n        ${CMAKE_CURRENT_SOURCE_DIR}\n)\n\n# Link Lua if enabled\nif(ENABLE_LUA_BINDINGS)\n    find_package(Lua REQUIRED)\n    target_link_libraries(playdate-engine PRIVATE ${LUA_LIBRARIES})\n    target_include_directories(playdate-engine PRIVATE ${LUA_INCLUDE_DIR})\nendif()\n\n# Platform-specific libraries\nif(PLAYDATE_TARGET STREQUAL \"simulator\")\n    if(PLAYDATE_PLATFORM STREQUAL \"Mac\")\n        find_library(CORE_FOUNDATION CoreFoundation)\n        target_link_libraries(playdate-engine PRIVATE ${CORE_FOUNDATION})\n    endif()\nendif()\n\n# Installation\ninstall(TARGETS playdate-engine\n    EXPORT PlaydateEngineTargets\n    LIBRARY DESTINATION ${CMAKE_INSTALL_LIBDIR}\n    ARCHIVE DESTINATION ${CMAKE_INSTALL_LIBDIR}\n    RUNTIME DESTINATION ${CMAKE_INSTALL_BINDIR}\n)\n\n# Export targets\ninstall(EXPORT PlaydateEngineTargets\n    FILE PlaydateEngineTargets.cmake\n    NAMESPACE PlaydateEngine::\n    DESTINATION ${CMAKE_INSTALL_LIBDIR}/cmake/PlaydateEngine\n)\n```\n\n### Step 4: Testing Configuration\n\n```cmake\n# cmake/Testing.cmake\n\n# Testing configuration module\n\nif(ENABLE_TESTING)\n    # Find testing framework (using minimal built-in testing)\n    \n    # Test configuration\n    set(CMAKE_CTEST_ARGUMENTS \"--output-on-failure\")\n    \n    # Custom test runner\n    function(add_engine_test TEST_NAME)\n        cmake_parse_arguments(ENGINE_TEST\n            \"\" # No boolean options\n            \"\" # No single value options\n            \"SOURCES;LIBRARIES\" # Multi-value options\n            ${ARGN}\n        )\n        \n        # Create test executable\n        add_executable(${TEST_NAME} ${ENGINE_TEST_SOURCES})\n        \n        # Link engine and test libraries\n        target_link_libraries(${TEST_NAME}\n            playdate-engine\n            ${ENGINE_TEST_LIBRARIES}\n        )\n        \n        # Compiler flags\n        target_compile_options(${TEST_NAME} PRIVATE ${ENGINE_C_FLAGS})\n        \n        # Add to CTest\n        add_test(NAME ${TEST_NAME} COMMAND ${TEST_NAME})\n        \n        # Set test properties\n        set_tests_properties(${TEST_NAME} PROPERTIES\n            TIMEOUT 30\n            FAIL_REGULAR_EXPRESSION \"FAILED|ERROR\"\n        )\n        \n    endfunction()\n    \n    # Performance benchmark function\n    function(add_engine_benchmark BENCHMARK_NAME)\n        cmake_parse_arguments(ENGINE_BENCHMARK\n            \"\" # No boolean options\n            \"\" # No single value options\n            \"SOURCES;LIBRARIES\" # Multi-value options\n            ${ARGN}\n        )\n        \n        # Create benchmark executable\n        add_executable(${BENCHMARK_NAME} ${ENGINE_BENCHMARK_SOURCES})\n        \n        # Link libraries\n        target_link_libraries(${BENCHMARK_NAME}\n            playdate-engine\n            ${ENGINE_BENCHMARK_LIBRARIES}\n        )\n        \n        # Compiler flags with optimization\n        target_compile_options(${BENCHMARK_NAME} PRIVATE ${ENGINE_C_FLAGS} -O3)\n        \n        # Add as test but with longer timeout\n        add_test(NAME ${BENCHMARK_NAME} COMMAND ${BENCHMARK_NAME})\n        set_tests_properties(${BENCHMARK_NAME} PROPERTIES\n            TIMEOUT 120\n            LABELS \"benchmark\"\n        )\n        \n    endfunction()\n    \nendif()\n```\n\n### Step 5: Build Scripts\n\n```bash\n#!/bin/bash\n# scripts/build.sh - Unix build script\n\nset -e\n\n# Configuration\nBUILD_TYPE=\"Debug\"\nPLAYDATE_TARGET=\"simulator\"\nENABLE_LUA=\"ON\"\nENABLE_TESTING=\"ON\"\nCLEAN_BUILD=\"false\"\n\n# Parse command line arguments\nwhile [[ $# -gt 0 ]]; do\n    case $1 in\n        --release)\n            BUILD_TYPE=\"Release\"\n            shift\n            ;;\n        --device)\n            PLAYDATE_TARGET=\"device\"\n            shift\n            ;;\n        --no-lua)\n            ENABLE_LUA=\"OFF\"\n            shift\n            ;;\n        --no-tests)\n            ENABLE_TESTING=\"OFF\"\n            shift\n            ;;\n        --clean)\n            CLEAN_BUILD=\"true\"\n            shift\n            ;;\n        --help)\n            echo \"Usage: $0 [options]\"\n            echo \"Options:\"\n            echo \"  --release      Build in Release mode (default: Debug)\"\n            echo \"  --device       Build for Playdate device (default: simulator)\"\n            echo \"  --no-lua       Disable Lua bindings\"\n            echo \"  --no-tests     Disable testing\"\n            echo \"  --clean        Clean build directory before building\"\n            echo \"  --help         Show this help message\"\n            exit 0\n            ;;\n        *)\n            echo \"Unknown option: $1\"\n            exit 1\n            ;;\n    esac\ndone\n\n# Build directory\nBUILD_DIR=\"build/${PLAYDATE_TARGET}-${BUILD_TYPE}\"\n\necho \"Building Playdate Engine...\"\necho \"  Build Type: $BUILD_TYPE\"\necho \"  Target: $PLAYDATE_TARGET\"\necho \"  Lua Bindings: $ENABLE_LUA\"\necho \"  Testing: $ENABLE_TESTING\"\necho \"  Build Directory: $BUILD_DIR\"\n\n# Clean build if requested\nif [ \"$CLEAN_BUILD\" = \"true\" ]; then\n    echo \"Cleaning build directory...\"\n    rm -rf \"$BUILD_DIR\"\nfi\n\n# Create build directory\nmkdir -p \"$BUILD_DIR\"\ncd \"$BUILD_DIR\"\n\n# Run CMake\necho \"Configuring with CMake...\"\ncmake \\\n    -DCMAKE_BUILD_TYPE=\"$BUILD_TYPE\" \\\n    -DPLAYDATE_TARGET=\"$PLAYDATE_TARGET\" \\\n    -DENABLE_LUA_BINDINGS=\"$ENABLE_LUA\" \\\n    -DENABLE_TESTING=\"$ENABLE_TESTING\" \\\n    ../..\n\n# Build\necho \"Building...\"\ncmake --build . --parallel $(nproc 2>/dev/null || echo 4)\n\n# Run tests if enabled\nif [ \"$ENABLE_TESTING\" = \"ON\" ]; then\n    echo \"Running tests...\"\n    ctest --output-on-failure\nfi\n\necho \"Build completed successfully!\"\necho \"Binaries are in: $BUILD_DIR\"\n```\n\n### Step 6: Example Project Configuration\n\n```cmake\n# examples/CMakeLists.txt\n\n# Example projects\n\nif(ENABLE_EXAMPLES)\n    \n    # Basic example\n    add_playdate_game(basic_example\n        SOURCES basic_example/main.c\n        ASSETS_DIR basic_example/assets\n    )\n    \n    # Platformer example\n    add_playdate_game(platformer_example\n        SOURCES \n            platformer_example/main.c\n            platformer_example/player.c\n            platformer_example/level.c\n        ASSETS_DIR platformer_example/assets\n    )\n    \n    # Lua scripted example (if Lua enabled)\n    if(ENABLE_LUA_BINDINGS)\n        add_playdate_game(lua_example\n            SOURCES lua_example/main.c\n            ASSETS_DIR lua_example/assets\n        )\n    endif()\n    \nendif()\n```\n\n## Unit Tests\n\n### Build System Tests\n\n```bash\n#!/bin/bash\n# tests/build/test_build_system.sh\n\nset -e\n\necho \"Testing build system...\"\n\n# Test basic build\necho \"Testing basic build...\"\n./scripts/build.sh --clean\n\n# Test release build\necho \"Testing release build...\"\n./scripts/build.sh --release --clean\n\n# Test device build (if toolchain available)\nif command -v arm-none-eabi-gcc &> /dev/null; then\n    echo \"Testing device build...\"\n    ./scripts/build.sh --device --clean\nfi\n\n# Test without Lua\necho \"Testing build without Lua...\"\n./scripts/build.sh --no-lua --clean\n\n# Test without tests\necho \"Testing build without tests...\"\n./scripts/build.sh --no-tests --clean\n\necho \"All build tests passed!\"\n```\n\n### CMake Configuration Tests\n\n```cmake\n# tests/cmake/test_configuration.cmake\n\n# Test CMake configuration\n\n# Test required variables\nif(NOT DEFINED PLAYDATE_SDK_PATH)\n    message(FATAL_ERROR \"PLAYDATE_SDK_PATH not defined\")\nendif()\n\nif(NOT EXISTS \"${PLAYDATE_SDK_PATH}/C_API/pd_api.h\")\n    message(FATAL_ERROR \"Playdate SDK not found\")\nendif()\n\n# Test build types\nset(VALID_BUILD_TYPES \"Debug\" \"Release\" \"RelWithDebInfo\" \"MinSizeRel\")\nif(NOT CMAKE_BUILD_TYPE IN_LIST VALID_BUILD_TYPES)\n    message(FATAL_ERROR \"Invalid build type: ${CMAKE_BUILD_TYPE}\")\nendif()\n\n# Test target platforms\nset(VALID_TARGETS \"simulator\" \"device\")\nif(NOT PLAYDATE_TARGET IN_LIST VALID_TARGETS)\n    message(FATAL_ERROR \"Invalid target: ${PLAYDATE_TARGET}\")\nendif()\n\nmessage(STATUS \"CMake configuration tests passed\")\n```\n\n## Integration Points\n\n### All Previous Phases\n- Build system compiles and links all engine components\n- Automated testing runs all unit tests and benchmarks\n- Asset pipeline processes game assets\n- Cross-platform support for development workflows\n\n## Build Targets\n\n### Library Targets\n- **playdate-engine**: Core engine library\n- **playdate-engine-lua**: Engine with Lua bindings\n- **playdate-engine-static**: Static library version\n\n### Executable Targets\n- **examples**: All example projects\n- **tests**: All unit tests and benchmarks\n- **tools**: Development tools and utilities\n\n### Custom Targets\n- **install**: Install engine libraries and headers\n- **package**: Create distribution packages\n- **docs**: Generate documentation\n- **format**: Format source code\n\n## Testing Criteria\n\n### Build Test Requirements\n- ✅ Clean build from source\n- ✅ Debug and Release configurations\n- ✅ Simulator and Device targets\n- ✅ With and without Lua bindings\n- ✅ Cross-platform compatibility\n- ✅ Asset pipeline functionality\n\n### Integration Test Requirements\n- ✅ Example projects build successfully\n- ✅ Unit tests run and pass\n- ✅ Performance benchmarks execute\n- ✅ Installation and packaging work\n\n## Success Criteria\n\n### Functional Requirements\n- [ ] Complete CMake-based build system\n- [ ] Playdate SDK integration for both simulator and device\n- [ ] Cross-platform development support\n- [ ] Automated testing integration\n- [ ] Asset processing pipeline\n\n### Developer Experience\n- [ ] Simple build scripts for common workflows\n- [ ] Clear build configuration options\n- [ ] Helpful error messages for common issues\n- [ ] Fast incremental builds\n- [ ] Easy setup for new developers\n\n### Quality Requirements\n- [ ] Comprehensive build testing\n- [ ] Documentation for all build processes\n- [ ] Automated CI/CD integration ready\n- [ ] Package distribution support\n\n## Next Steps\n\nUpon completion of this phase:\n1. Verify all build configurations work correctly\n2. Test cross-platform compatibility\n3. Validate example project builds\n4. Proceed to Phase 10: Optimization implementation\n5. Begin implementing performance analysis and optimization tools\n\nThis phase provides the development infrastructure that enables efficient engine development, testing, and distribution across all supported platforms.